

# 用户,组,权限命令([参考](http://c.biancheng.net/linux_tutorial/60/))

## 文件说明

- /etc/passwd

> 记录用户基本属性, 依次为:
>
> 用户名:密码:UID:GID:注释描述:宿主目录:shell类型

- /etc/shadow

> 用户的密码信息，又称为“影子文件”
>
> 用户名:加密密码:最后一次修改时间:最小修改时间间隔:密码有效期:密码需要变更前的警告天数:密码过期后的宽限时间:账号失效时间:保留字段

- /etc/group

> 用户组配置文件
>
> 组名:组密码:组ID:组中的附加用户
>
> 组密码: 和 /etc/passwd 文件一样, 这里的 "x" 仅仅是密码标识，真正加密后的组密码默认保存在 /etc/gshadow 文件中
>
> 组ID(GID): 组 GID 与 /etc/passwd 文件中第 4 个字段的 GID 相对应
>
> 组中的用户: 该字段显示的用户都是这个用户组的附加用户, 不是用户的初始组

- /etc/gshadow

> 组名:组密码:组管理员:组中的附加用户
>
> 组中的附加用户:和 /etc/group 文件中附加组显示内容相同

- /etc/skel

>存放新用户配置文件的目录，当我们添加新用户的时候，这个目录下的所有文件会自动被复制到新添加的用户的家目录下

## useradd/adduser 添加用户

> useradd [选项] [用户名]

| 选项 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| -u   | 手工指定用户的 UID，注意手工添加的用户的 UID 不要小于 500    |
| -d   | 手工指定用户的家目录。家目录必须写绝对路径，而且如果需要手工指定家目录，则一定要注意权限 |
| -c   | 手工指定用户说明。 /etc/passwd 文件的第5个字段就是该字段内容的 |
| -g   | 手工指定用户的初始组。在创建用户时会默认以用户名相同的组作为用户的初始组。如果不想使用默认初始组，则可以用 -g 手工指定。不建议手工修改 |
| -G   | 指定用户的附加组。我们把用户加入其他组，一般都使用附加组     |
| -s   | 手工指定用户的登录 Shell。默认是 /bin/bash                   |
| -e   | 指定用户的失效曰期，格式为"YYYY-MM-DD"。也就是/etc/shadow文件的第8个字段 |
| -o   | 允许创建的用户的 UID 相同。例如，执行"useradd -u 0 -o usertest"命令建立用户 usertest，它的 UID 和 root 用户的 UID 相同，都是 0 |

## usermod 用户信息修改

> 大部分选项跟useradd的一样
>
> usermod [选项] [用户名]

| 选项 | 说明                 |
| ---- | -------------------- |
| -L   | 临时锁定用户（Lock） |
| -U   | 解锁用户（Unlock）   |



userdel 删除用户

> -r 在删除用户的同时删除用户的家目录
>
> userdel [-r] 用户名

## passwd 修改密码

> passwd [选项] [用户名]

| 选项    | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| -S      | 査询用户密码的状态，也就是 /etc/shadow 文件中的内容。仅 root 用户可用 |
| -l      | 暂时锁定用户。仅 root 用户可用                               |
| -u      | 解锁用户。仅 root 用户可用                                   |
| --stdin | 可以将通过管道符输出的数据作为用户的密码。主要在批量添加用户时使用 |

## chage 修改密码状态

> chage [选项] [用户名]

| 选项     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| -l       | 列出用户的详细密码状态                                       |
| -d  日期 | 密码最后一次修改曰期（/etc/shadow 文件的第三个字段），格式为 YYYY-MM-DD |
| -m 天数  | 密码的两次修改间隔时间（/etc/shadow第4个字段）               |
| -M天数   | 密码的有效期（/etc/shadow第5个字段）                         |
| -W天数   | 密码修改到期前的警告天数（/etc/shadow第6个字段）             |
| -i天数   | 密码过期后的宽限天数（/etc/shadow第7个字段）                 |
| -E 日期  | 账号失效时间（/etc/shadow第8个字段），格式为 YYYY-MM-DD      |

## gpasswd 添加或删除组用户附加组

> gpasswd [选项] [用户名] [组名]

| 选项 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
|      | 选项为空时，表示给群组设置密码，仅 root 用户可用             |
| -A   | 将群组的控制权交给 user1,... 等用户管理，也就是说，设置 user1,... 等用户为群组的管理员，仅 root 用户可用 |
| -M   | 将 user1,... 加入到此群组中，仅 root 用户可用                |
| -r   | 移除群组的密码，仅 root 用户可用                             |
| -R   | 让群组的密码失效，仅 root 用户可用                           |
| -a   | 将 user 用户加入到群组中                                     |
| -d   | 将 user 用户从群组中移除                                     |

